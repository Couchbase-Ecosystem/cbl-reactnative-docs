"use strict";(self.webpackChunkcbl_reactnative=self.webpackChunkcbl_reactnative||[]).push([[9314],{5188:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>g,frontMatter:()=>t,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"Troubleshooting/using-logs","title":"Using Logs for Troubleshooting","description":"Description \u2014 Couchbase Lite on React Native \u2014 Using Logs for Troubleshooting","source":"@site/docs/Troubleshooting/using-logs.md","sourceDirName":"Troubleshooting","slug":"/Troubleshooting/using-logs","permalink":"/Troubleshooting/using-logs","draft":false,"unlisted":false,"editUrl":"https://github.com/Couchbase-Ecosystem/cbl-reactnative-docs/docs/Troubleshooting/using-logs.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"id":"using-logs","sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Troubleshooting","permalink":"/category/troubleshooting"},"next":{"title":"Troubleshooting Queries","permalink":"/Troubleshooting/troubleshoot-queries"}}');var l=i(4848),s=i(8453);const t={id:"using-logs",sidebar_position:1},r="Using Logs for Troubleshooting",a={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Log Sink API",id:"log-sink-api",level:2},{value:"Log Levels",id:"log-levels",level:3},{value:"Log Domains",id:"log-domains",level:3},{value:"Console Log Sink",id:"console-log-sink",level:2},{value:"Example 1. Enable Console Logging",id:"example-1-enable-console-logging",level:4},{value:"Example 2. Console with Specific Domains",id:"example-2-console-with-specific-domains",level:4},{value:"Example 3. Disable Console Logging",id:"example-3-disable-console-logging",level:4},{value:"File Log Sink",id:"file-log-sink",level:2},{value:"Example 4. Enable File Logging",id:"example-4-enable-file-logging",level:4},{value:"Example 5. Disable File Logging",id:"example-5-disable-file-logging",level:4},{value:"Custom Log Sink",id:"custom-log-sink",level:2},{value:"Example 6. Custom Logging with Callback",id:"example-6-custom-logging-with-callback",level:4},{value:"Example 7. Disable Custom Logging",id:"example-7-disable-custom-logging",level:4},{value:"Using Multiple Log Sinks",id:"using-multiple-log-sinks",level:2},{value:"Example 8. Development and Production Configuration",id:"example-8-development-and-production-configuration",level:4},{value:"Platform Considerations",id:"platform-considerations",level:2}];function c(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"using-logs-for-troubleshooting",children:"Using Logs for Troubleshooting"})}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:["Description \u2014 ",(0,l.jsx)(n.em,{children:"Couchbase Lite on React Native \u2014 Using Logs for Troubleshooting"}),(0,l.jsx)(n.br,{}),"\n","Related Content \u2014 ",(0,l.jsx)(n.a,{href:"troubeshoot-queries.md",children:"Troubleshooting Queries"})," | ",(0,l.jsx)(n.a,{href:"/Troubleshooting/troubleshoot-crashes",children:"Troubleshooting Crashes"})]}),"\n"]}),"\n",(0,l.jsx)(n.admonition,{type:"note",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"The retrieval of logs from the device is out of scope of this feature."}),"\n"]})}),"\n",(0,l.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,l.jsx)(n.p,{children:"Couchbase Lite provides a robust Logging API \u2014 see: API References for Logging classes \u2014 which make debugging and troubleshooting easier during development and in production. It delivers flexibility in terms of how logs are generated and retained, whilst also maintaining the level of logging required by Couchbase Support for investigation of issues."}),"\n",(0,l.jsx)(n.p,{children:"Log output is split into the following streams:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"File based logging"}),"\n",(0,l.jsx)(n.p,{children:"Here logs are written to separate log files filtered by log level, with each log level supporting individual retention policies."}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Console based logging"}),"\n",(0,l.jsx)(n.p,{children:"You can independently configure and control console logs, which provides a convenient method of accessing diagnostic information during debugging scenarios. With console logging, you can fine-tune diagnostic output to suit specific debug scenarios, without interfering with any logging required by Couchbase Support for the investigation of issues."}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Custom logging"}),"\n",(0,l.jsx)(n.p,{children:"For greater flexibility you can implement a custom logging class using the ILogger interface."}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"log-sink-api",children:"Log Sink API"}),"\n",(0,l.jsx)(n.p,{children:"Version 1.0 introduces the Log Sink API which provides three types of log sinks for flexible logging control."}),"\n",(0,l.jsx)(n.h3,{id:"log-levels",children:"Log Levels"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Level"}),(0,l.jsx)(n.th,{children:"Value"}),(0,l.jsx)(n.th,{children:"Description"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"LogLevel.DEBUG"}),(0,l.jsx)(n.td,{children:"0"}),(0,l.jsx)(n.td,{children:"Most verbose - all logs"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"LogLevel.VERBOSE"}),(0,l.jsx)(n.td,{children:"1"}),(0,l.jsx)(n.td,{children:"Detailed diagnostic logs"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"LogLevel.INFO"}),(0,l.jsx)(n.td,{children:"2"}),(0,l.jsx)(n.td,{children:"Informational messages"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"LogLevel.WARNING"}),(0,l.jsx)(n.td,{children:"3"}),(0,l.jsx)(n.td,{children:"Warning messages only"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"LogLevel.ERROR"}),(0,l.jsx)(n.td,{children:"4"}),(0,l.jsx)(n.td,{children:"Error messages only"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"LogLevel.NONE"}),(0,l.jsx)(n.td,{children:"5"}),(0,l.jsx)(n.td,{children:"No logging"})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"log-domains",children:"Log Domains"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Domain"}),(0,l.jsx)(n.th,{children:"Description"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"LogDomain.DATABASE"}),(0,l.jsx)(n.td,{children:"Database operations"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"LogDomain.QUERY"}),(0,l.jsx)(n.td,{children:"Query execution and planning"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"LogDomain.REPLICATOR"}),(0,l.jsx)(n.td,{children:"Replication activity"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"LogDomain.NETWORK"}),(0,l.jsx)(n.td,{children:"Network operations"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"LogDomain.LISTENER"}),(0,l.jsx)(n.td,{children:"Change listeners"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"LogDomain.ALL"}),(0,l.jsx)(n.td,{children:"All domains (new in 1.0)"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"console-log-sink",children:"Console Log Sink"}),"\n",(0,l.jsx)(n.p,{children:"Console based logging outputs logs to the system console (stdout/stderr), useful for development and debugging."}),"\n",(0,l.jsx)(n.h4,{id:"example-1-enable-console-logging",children:"Example 1. Enable Console Logging"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"import { LogSinks, LogLevel, LogDomain } from 'cbl-reactnative';\n\n// Enable verbose logging for all domains\nawait LogSinks.setConsole({\n  level: LogLevel.VERBOSE,\n  domains: [LogDomain.ALL]\n});\n"})}),"\n",(0,l.jsx)(n.h4,{id:"example-2-console-with-specific-domains",children:"Example 2. Console with Specific Domains"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"// Log only replication and network activity\nawait LogSinks.setConsole({\n  level: LogLevel.INFO,\n  domains: [LogDomain.REPLICATOR, LogDomain.NETWORK]\n});\n"})}),"\n",(0,l.jsx)(n.h4,{id:"example-3-disable-console-logging",children:"Example 3. Disable Console Logging"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"// Disable console logging\nawait LogSinks.setConsole(null);\n"})}),"\n",(0,l.jsx)(n.h2,{id:"file-log-sink",children:"File Log Sink"}),"\n",(0,l.jsx)(n.p,{children:"File logging writes logs to files on the device with automatic rotation and retention policies."}),"\n",(0,l.jsx)(n.h4,{id:"example-4-enable-file-logging",children:"Example 4. Enable File Logging"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"import { Platform } from 'react-native';\nimport RNFS from 'react-native-fs';\n\n// Determine platform-specific log directory\nconst logDirectory = Platform.OS === 'ios' \n  ? RNFS.DocumentDirectoryPath + '/logs'\n  : RNFS.ExternalDirectoryPath + '/logs';\n\nawait LogSinks.setFile({\n  level: LogLevel.INFO,\n  directory: logDirectory,\n  maxKeptFiles: 5,          // Keep 5 old log files\n  maxFileSize: 1024 * 1024, // 1MB max file size\n  usePlaintext: true        // Use plaintext format\n});\n"})}),"\n",(0,l.jsx)(n.admonition,{title:"File Rotation",type:"note",children:(0,l.jsxs)(n.p,{children:["When a log file reaches ",(0,l.jsx)(n.code,{children:"maxFileSize"}),", it's closed and a new one is created. Old files exceeding ",(0,l.jsx)(n.code,{children:"maxKeptFiles"})," are automatically deleted."]})}),"\n",(0,l.jsx)(n.h4,{id:"example-5-disable-file-logging",children:"Example 5. Disable File Logging"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"await LogSinks.setFile(null);\n"})}),"\n",(0,l.jsx)(n.h2,{id:"custom-log-sink",children:"Custom Log Sink"}),"\n",(0,l.jsx)(n.p,{children:"Custom logging allows you to implement your own logging logic with a callback function."}),"\n",(0,l.jsx)(n.h4,{id:"example-6-custom-logging-with-callback",children:"Example 6. Custom Logging with Callback"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"await LogSinks.setCustom({\n  level: LogLevel.ERROR,\n  domains: [LogDomain.ALL],\n  callback: (level, domain, message) => {\n    const timestamp = new Date().toISOString();\n    console.log(`[${timestamp}] [${domain}] ${message}`);\n    \n    // You can also send to analytics, log to database, etc.\n  }\n});\n"})}),"\n",(0,l.jsx)(n.h4,{id:"example-7-disable-custom-logging",children:"Example 7. Disable Custom Logging"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"await LogSinks.setCustom(null);\n"})}),"\n",(0,l.jsx)(n.h2,{id:"using-multiple-log-sinks",children:"Using Multiple Log Sinks"}),"\n",(0,l.jsx)(n.p,{children:"You can enable multiple log sinks simultaneously for different purposes."}),"\n",(0,l.jsx)(n.h4,{id:"example-8-development-and-production-configuration",children:"Example 8. Development and Production Configuration"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"if (__DEV__) {\n  // Development: Verbose console logging\n  await LogSinks.setConsole({\n    level: LogLevel.VERBOSE,\n    domains: [LogDomain.ALL]\n  });\n} else {\n  // Production: File logging for warnings and errors\n  await LogSinks.setFile({\n    level: LogLevel.WARNING,\n    directory: logDirectory,\n    maxKeptFiles: 7,\n    maxFileSize: 2 * 1024 * 1024,\n    usePlaintext: true\n  });\n  \n  // Also send errors to analytics\n  await LogSinks.setCustom({\n    level: LogLevel.ERROR,\n    domains: [LogDomain.ALL],\n    callback: (level, domain, message) => {\n      Analytics.logError({ level, domain, message });\n    }\n  });\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"platform-considerations",children:"Platform Considerations"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"iOS:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Log files are stored in the app's Documents directory"}),"\n",(0,l.jsxs)(n.li,{children:["Path: ",(0,l.jsx)(n.code,{children:"RNFS.DocumentDirectoryPath + '/logs'"})]}),"\n",(0,l.jsx)(n.li,{children:"Accessible via iTunes File Sharing if enabled in Info.plist"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Android:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Log files are stored in the app's external directory"}),"\n",(0,l.jsxs)(n.li,{children:["Path: ",(0,l.jsx)(n.code,{children:"RNFS.ExternalDirectoryPath + '/logs'"})]}),"\n",(0,l.jsx)(n.li,{children:"May require storage permissions in AndroidManifest.xml"}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>r});var o=i(6540);const l={},s=o.createContext(l);function t(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);